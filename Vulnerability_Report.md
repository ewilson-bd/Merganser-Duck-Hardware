# Vulnerability Assessment Report – WebGoat

**Όνομα:** [ΘΩΜΑΣ ΖΩΤΟΣ]  
**Ημερομηνία:** [π.χ. 14/05/2025]  
**Μάθημα:** Ασφάλεια Η/Υ  
**Εργαλείο Ανάλυσης:** GitHub CodeQL  
**Project:** WebGoat  
**Repository:** []

---

## 📌 Περιγραφή Εργασίας

Η εργασία αφορά στατική ανάλυση (SAST) στο έργο WebGoat, με στόχο τον εντοπισμό πιθανών ευπαθειών στον πηγαίο κώδικα πριν την εκτέλεση. Χρησιμοποιήθηκε το εργαλείο **CodeQL** από το GitHub Security.

Οι ευπάθειες κατηγοριοποιούνται σύμφωνα με το σύστημα **CWE (Common Weakness Enumeration)** και καταγράφηκαν οι πιο κρίσιμες από αυτές (Critical και High Severity).

---

## 🧪 Εντοπισμένες Ευπάθειες

Η στατική ανάλυση εντόπισε συνολικά **6** ευπάθειες, από τις οποίες:
- **3** χαρακτηρίστηκαν ως **Critical**
- **3** χαρακτηρίστηκαν ως **High**
- Επιλέχθηκαν όλες οι **Critical** και 3 **High** για αναλυτική τεκμηρίωση.

---

(Πρόκειται για δεύτερο παρόμοιο συμβάν στην ίδια κατηγορία ευπάθειας με διαφορετικό αρχείο)

Περιγραφή Ευπάθειας
Η εφαρμογή χρησιμοποιεί δεδομένα που δίνει ο χρήστης για να κατασκευάσει διαδρομές αρχείων (file paths), χωρίς να ελέγχει ή να καθαρίζει αυτά τα δεδομένα. Αυτό μπορεί να επιτρέψει σε επιτιθέμενο να πραγματοποιήσει επίθεση τύπου Path Traversal.

🚨 Επιπτώσεις
Ανάγνωση αρχείων έξω από τον επιτρεπόμενο φάκελο (π.χ. /etc/passwd, C:\Windows\System32)

Διαρροή ευαίσθητων πληροφοριών

Αλλαγή ή διαγραφή κρίσιμων αρχείων

Ενδεχόμενη απομακρυσμένη εκτέλεση κώδικα (RCE) σε συνδυασμό με άλλες ευπάθειες


Βήματα για Διόρθωση
Καθαρισμός Εισόδου Χρήστη:
Αφαίρεση χαρακτήρων όπως ../, /, \ που επιτρέπουν αλλαγή καταλόγων.

Χρήση Κανονικής Διαδρομής (Canonical Path):

File baseDir = new File("files/");
File requestedFile = new File(baseDir, userInput);
String canonicalBase = baseDir.getCanonicalPath();
String canonicalRequested = requestedFile.getCanonicalPath();

if (!canonicalRequested.startsWith(canonicalBase)) {
    throw new SecurityException("Μη επιτρεπόμενη διαδρομή αρχείου");
}

Περιγραφή Ευπάθειας
Η εφαρμογή χρησιμοποιεί δεδομένα από τον χρήστη για να κατασκευάσει διαδρομές αρχείων χωρίς έλεγχο, κάτι που επιτρέπει "Path Traversal".

🚨 Επιπτώσεις
Πρόσβαση σε αρχεία έξω από τον επιτρεπόμενο κατάλογο (π.χ. ../../../etc/passwd)

Παραβίαση ευαίσθητων πληροφοριών

Πιθανή υπεξαίρεση ή καταστροφή δεδομένων

🛠️ Βήματα για Διόρθωση
Καθάρισε την είσοδο του χρήστη: αφαίρεσε .., /, \ κλπ.

Χρησιμοποίησε μόνο επιτρεπόμενους φακέλους ή επέτρεψε μόνο συγκεκριμένες διαδρομές.

Χρησιμοποίησε white-list για ονόματα αρχείων.

Χρησιμοποίησε getCanonicalPath() για να ανιχνεύσεις απόπειρες παράκαμψης:
File file = new File(baseDir, userInput);
String canonicalPath = file.getCanonicalPath();
if (!canonicalPath.startsWith(baseDir.getCanonicalPath())) {
    throw new SecurityException("Invalid path");
}
